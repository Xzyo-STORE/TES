<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Xzyo Store - Joki Blox Fruits</title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">

<style>
body{
    margin:0;
    font-family:Arial, Helvetica, sans-serif;
    background:#0f172a;
    color:white;
}

.container{
    display:flex;
    gap:20px;
    padding:20px;
}

.left-side,
.right-side{
    flex:1;
    background:#1e293b;
    padding:20px;
    border-radius:12px;
}

h2{
    margin-top:0;
}

input, select{
    width:100%;
    padding:10px;
    margin-bottom:12px;
    border-radius:8px;
    border:none;
}

.btn{
    width:100%;
    padding:12px;
    border:none;
    border-radius:8px;
    background:linear-gradient(90deg,#2563eb,#3b82f6);
    color:white;
    font-weight:bold;
    cursor:pointer;
}

.price-list{
    list-style:none;
    padding:0;
}

.price-list li{
    display:flex;
    justify-content:space-between;
    margin-bottom:10px;
    padding:8px;
    background:#334155;
    border-radius:8px;
}

.old-p{
    text-decoration:line-through;
    opacity:0.5;
}

.new-p{
    color:#22c55e;
    font-weight:bold;
}

#order-slide{
    display:none;
    align-items:center;
    justify-content:center;
    height:200px;
    font-size:20px;
    font-weight:bold;
}

.active{
    display:flex !important;
}

@media (max-width:768px){
    .container{
        flex-direction:column;
    }
}
</style>
</head>

<body>

<div class="container">

<div class="left-side">
<h2>Form Order</h2>

<form id="orderForm">

<input type="text" id="usernameInput" placeholder="Username Game" required>

<input type="password" id="pw" placeholder="Password" required>
<i class="fa-solid fa-eye-slash" onclick="togglePw()" style="cursor:pointer;margin-bottom:10px;"></i>

<select required>
<option value="">Pilih Paket</option>
<option>Raid 10x</option>
<option>Leveling</option>
<option>Full Service</option>
</select>

<input type="text" id="voucherInput" placeholder="Kode Voucher (Opsional)">
<button type="button" class="btn" onclick="cekVoucher()" style="background:linear-gradient(90deg,#16a34a,#22c55e)">Gunakan Voucher</button>

<button type="submit" class="btn">ORDER SEKARANG</button>

<input type="hidden" name="email_subject" id="email_subject">

</form>

<div id="order-slide">
âœ… Order Berhasil Diproses
</div>

</div>

<div class="right-side">
<h2>Daftar Harga</h2>

<ul class="price-list">
<li><span>Raid 10x</span> <span><span class="old-p">30k</span> <span class="new-p">25k</span></span></li>
<li><span>Leveling</span> <span><span class="old-p">50k</span> <span class="new-p">45k</span></span></li>
<li><span>Full Service</span> <span><span class="old-p">100k</span> <span class="new-p">90k</span></span></li>
</ul>

</div>

</div>

<script>

// PASSWORD
function togglePw(){
    let pw = document.getElementById("pw");
    if(pw.type === "password"){
        pw.type = "text";
    } else {
        pw.type = "password";
    }
}

// VOUCHER SYSTEM
let diskonAktif = 0;
let hargaAsli = [];

const voucherList = {
    "123â…˜5778": 15,
    "XZYO10": 10,
    "LEK20": 20
};

document.addEventListener("DOMContentLoaded", function(){
    let hargaList = document.querySelectorAll(".new-p");
    hargaList.forEach((item, index)=>{
        hargaAsli[index] = item.innerText;
    });
    resetMingguan();
});

function cekVoucher(){
    let kode = document.getElementById("voucherInput").value.trim().toUpperCase();

    if(voucherList[kode]){
        if(cekLimitVoucher(kode)){
            diskonAktif = voucherList[kode];
            alert("Voucher "+diskonAktif+"% berhasil digunakan ðŸ”¥");
            updateHarga();
        } else {
            alert("Voucher sudah dipakai 3x minggu ini âŒ");
        }
    } else {
        alert("Kode voucher tidak valid âŒ");
    }
}

function updateHarga(){
    let hargaList = document.querySelectorAll(".new-p");
    hargaList.forEach((item,index)=>{
        let harga = parseFloat(hargaAsli[index].replace("k",""));
        let hasil = harga - (harga * diskonAktif / 100);
        item.innerText = hasil.toFixed(1) + "k";
    });
}

function resetHarga(){
    let hargaList = document.querySelectorAll(".new-p");
    hargaList.forEach((item,index)=>{
        item.innerText = hargaAsli[index];
    });
    diskonAktif = 0;
    document.getElementById("voucherInput").value = "";
}

// LIMIT 3X PER MINGGU
function cekLimitVoucher(kode){
    let data = JSON.parse(localStorage.getItem("voucherData")) || {};

    if(!data[kode]){
        data[kode] = {count:0, week:getWeek()};
    }

    if(data[kode].week !== getWeek()){
        data[kode].count = 0;
        data[kode].week = getWeek();
    }

    if(data[kode].count >= 3){
        return false;
    }

    data[kode].count++;
    localStorage.setItem("voucherData", JSON.stringify(data));
    return true;
}

function getWeek(){
    let now = new Date();
    let firstJan = new Date(now.getFullYear(),0,1);
    let days = Math.floor((now - firstJan)/(24*60*60*1000));
    return Math.ceil((days + firstJan.getDay()+1)/7);
}

function resetMingguan(){
    let data = JSON.parse(localStorage.getItem("voucherData")) || {};
    let mingguSekarang = getWeek();

    for(let kode in data){
        if(data[kode].week !== mingguSekarang){
            data[kode].count = 0;
            data[kode].week = mingguSekarang;
        }
    }

    localStorage.setItem("voucherData", JSON.stringify(data));
}

document.getElementById("orderForm").addEventListener("submit", function(e){
    e.preventDefault();

    let nama = document.getElementById("usernameInput").value;
    document.getElementById("email_subject").value = "Pesanan Joki dari: " + nama;

    resetHarga();

    let form = this;
    let slide = document.getElementById("order-slide");

    form.style.display = "none";
    slide.classList.add("active");
});

</script>

</body>
    </html>
